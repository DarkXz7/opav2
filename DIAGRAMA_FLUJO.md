# ğŸ—ºï¸ DIAGRAMA DE FLUJO - SISTEMA DE VALIDACIÃ“N Y NORMALIZACIÃ“N

## ğŸ“Š FLUJO COMPLETO DEL SISTEMA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USUARIO SUBE ARCHIVO EXCEL                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    views.py: upload_excel_file()                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. Guarda archivo en storage                             â”‚   â”‚
â”‚  â”‚ 2. Crea objeto DataSource                                â”‚   â”‚
â”‚  â”‚ 3. âŒ ANTES: redirect('/sheets/')                        â”‚   â”‚
â”‚  â”‚    âœ… AHORA: redirect('/multi-config/')  â† DIRECTO       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              views.py: excel_multi_sheet_config()               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. Lee archivo Excel con pandas                          â”‚   â”‚
â”‚  â”‚ 2. Por cada hoja:                                        â”‚   â”‚
â”‚  â”‚    a) Lee columnas                                       â”‚   â”‚
â”‚  â”‚    b) ğŸ†• Llama infer_sql_type() por cada columna        â”‚   â”‚
â”‚  â”‚    c) Genera preview (primeras 5 filas)                 â”‚   â”‚
â”‚  â”‚    d) ğŸ†• Sugiere nombre normalizado con normalize_name()â”‚   â”‚
â”‚  â”‚ 3. Renderiza template con datos + tipos inferidos       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      TEMPLATE: excel_multi_sheet_selector.html (FRONTEND)       â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ†• SECCIÃ“N 1: RENOMBRADO DE HOJA ACTIVA                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Input: [ventas_2024________] [Validar]            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ onClick "Validar":                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   â†’ AJAX POST /validate-sheet-rename/            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   â†’ Backend: validate_sheet_name()               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   â†’ Retorna: {valid, normalized, error}          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   â†’ Muestra feedback (verde/rojo)                â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ†• SECCIÃ“N 2: LISTA DE COLUMNAS                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ [Seleccionar todas] â† ğŸ†• MOVIDO AQUÃ (DEBAJO)    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â˜ edad                                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â˜ nombre                                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ â˜‘ salario â† SELECCIONADO                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   â”‚                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€> ğŸ†• CONFIGURACIÃ“N EXPANDIBLE (slideDown)    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚ Renombrar: [salario_____] âœ…         â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚ Tipo SQL: [FLOAT â–¼] âœ…               â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚   ğŸ’¡ Sugerido: FLOAT (100% conf.)    â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚                                       â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚ onChange:                            â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚   â†’ AJAX POST /infer-types/         â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚   â†’ Backend: infer_sql_type()       â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚   â†’ Actualiza selector + hint       â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚                                       â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚ â˜‘ Puede ser NULL âœ…                  â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚                                       â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚ onChange:                            â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚   â†’ toggleDefaultInput()            â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚   â†’ Habilita/deshabilita default    â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚                                       â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚ Valor por defecto: [0.0__] âœ…        â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â”‚   (Placeholder dinÃ¡mico: "Ej: 0.0") â”‚   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ†• SECCIÃ“N 3: BOTÃ“N GUARDAR                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ [Guardar ConfiguraciÃ³n y Procesar]                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ onClick:                                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   â†’ Construye JSON con todas las configuraciones â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   â†’ POST /save-and-process/                      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              models.py: MigrationProcess.run()                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. Lee Excel con pandas                                  â”‚   â”‚
â”‚  â”‚ 2. Por cada hoja seleccionada:                           â”‚   â”‚
â”‚  â”‚    a) Obtiene column_mappings del JSON                   â”‚   â”‚
â”‚  â”‚    b) ğŸ†• Valida con validate_column_mappings()          â”‚   â”‚
â”‚  â”‚       â†’ Verifica columnas existen                       â”‚   â”‚
â”‚  â”‚       â†’ Verifica no duplicados                          â”‚   â”‚
â”‚  â”‚       â†’ Verifica tipos SQL vÃ¡lidos                      â”‚   â”‚
â”‚  â”‚    c) ğŸ†• Normaliza con normalize_dataframe_by_mappings()â”‚   â”‚
â”‚  â”‚       â†’ Por cada valor:                                 â”‚   â”‚
â”‚  â”‚         - INT vacÃ­o + no nullable â†’ 0                   â”‚   â”‚
â”‚  â”‚         - FLOAT vacÃ­o + no nullable â†’ 0.0               â”‚   â”‚
â”‚  â”‚         - VARCHAR vacÃ­o + no nullable â†’ ''              â”‚   â”‚
â”‚  â”‚         - DATE vacÃ­o + no nullable â†’ GETDATE()          â”‚   â”‚
â”‚  â”‚         - BIT: true/yes/sÃ­ â†’ 1, false/no â†’ 0            â”‚   â”‚
â”‚  â”‚    d) Llama _save_dataframe_to_destination()            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      models.py: _save_dataframe_to_destination()                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. Renombra columnas segÃºn mappings                      â”‚   â”‚
â”‚  â”‚ 2. ğŸ†• Logging mejorado:                                  â”‚   â”‚
â”‚  â”‚    - Log SQL generado completo                           â”‚   â”‚
â”‚  â”‚    - Log filas procesadas vs fallidas                    â”‚   â”‚
â”‚  â”‚    - Log columnas con errores                            â”‚   â”‚
â”‚  â”‚ 3. Construye query INSERT                                â”‚   â”‚
â”‚  â”‚    INSERT INTO tabla (col1, col2) VALUES (?, ?)          â”‚   â”‚
â”‚  â”‚ 4. Ejecuta en lotes (1,000 registros)                    â”‚   â”‚
â”‚  â”‚ 5. Commit por lote                                       â”‚   â”‚
â”‚  â”‚ 6. ğŸ†• Logging de progreso:                               â”‚   â”‚
â”‚  â”‚    "Insertados 1000/5000 registros"                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SQL SERVER                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ… Datos insertados en tabla                              â”‚   â”‚
â”‚  â”‚ âœ… Valores normalizados correctamente                     â”‚   â”‚
â”‚  â”‚ âœ… Constraints respetados (NOT NULL, tipos correctos)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLUJO DE VALIDACIÃ“N EN TIEMPO REAL

### Caso 1: Usuario Renombra Hoja

```
[Usuario escribe "Ventas 2024!" en input]
         â”‚
         â–¼
[onClick BotÃ³n "Validar"]
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript: validateSheetRename()â”‚
â”‚  1. Obtiene valor del input     â”‚
â”‚  2. Obtiene nombres existentes  â”‚
â”‚  3. Llama AJAX POST             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend: /validate-sheet-rename/     â”‚
â”‚  1. Recibe: new_name, existing_names â”‚
â”‚  2. Llama validate_sheet_name()      â”‚
â”‚  3. normalize_name("Ventas 2024!")   â”‚
â”‚     â†’ "ventas_2024"                  â”‚
â”‚  4. Verifica duplicados              â”‚
â”‚  5. Retorna JSON                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
{
  "valid": true,
  "normalized": "ventas_2024",
  "error": null
}
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript: procesa respuesta   â”‚
â”‚  1. input.value = "ventas_2024" â”‚
â”‚  2. input.classList.add('is-valid')â”‚
â”‚  3. Muestra mensaje verde       â”‚
â”‚  4. Guarda en sheetRenames{}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Caso 2: Usuario Selecciona Columna

```
[Usuario marca checkbox de "edad"]
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript: updateColumnSelection()   â”‚
â”‚  1. checkbox.checked = true           â”‚
â”‚  2. Muestra configDiv (slideDown)     â”‚
â”‚  3. Habilita todos los inputs         â”‚
â”‚  4. Llama inferTypeForColumn()        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript: inferTypeForColumn()      â”‚
â”‚  1. Muestra "â³ Analizando..."        â”‚
â”‚  2. AJAX POST /infer-types/          â”‚
â”‚  3. EnvÃ­a: {sheet_name, columns}     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend: views.infer_column_types()  â”‚
â”‚  1. Lee Excel con pandas             â”‚
â”‚  2. Obtiene serie de columna "edad"  â”‚
â”‚  3. Llama infer_sql_type(serie)      â”‚
â”‚     â†’ Analiza valores: [25, 30, ...]â”‚
â”‚     â†’ Detecta rango: 0-255          â”‚
â”‚     â†’ Retorna: TINYINT              â”‚
â”‚  4. Retorna JSON                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
{
  "types": {
    "edad": {
      "sql_type": "TINYINT",
      "confidence": 1.0,
      "nullable": false,
      "default_value": "0",
      "warnings": []
    }
  }
}
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript: procesa respuesta         â”‚
â”‚  1. typeSelector.value = "TINYINT"    â”‚
â”‚  2. hintElement.text = "ğŸ’¡ Sugerido:  â”‚
â”‚     TINYINT (100% confianza)"         â”‚
â”‚  3. nullableCheckbox.checked = false  â”‚
â”‚  4. defaultInput.placeholder = "Ej: 0"â”‚
â”‚  5. defaultInput.disabled = false     â”‚
â”‚     (porque nullable=false)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ FLUJO DE NORMALIZACIÃ“N DE VALORES

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DATAFRAME ORIGINAL (PANDAS)                    â”‚
â”‚                                                                 â”‚
â”‚   edad    nombre     salario    activo    fecha                â”‚
â”‚   "25"    "Juan"     "1500.50"  "true"    "2024-01-15"         â”‚
â”‚   None    "MarÃ­a"    "2000"     "false"   None                 â”‚
â”‚   "30"    None       None       "1"       "2024-03-30"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COLUMN MAPPINGS (CONFIGURACIÃ“N JSON)               â”‚
â”‚                                                                 â”‚
â”‚  {                                                              â”‚
â”‚    "edad": {                                                    â”‚
â”‚      "sql_type": "INT",                                         â”‚
â”‚      "nullable": false,                                         â”‚
â”‚      "default_value": "0"                                       â”‚
â”‚    },                                                           â”‚
â”‚    "nombre": {                                                  â”‚
â”‚      "sql_type": "NVARCHAR(100)",                               â”‚
â”‚      "nullable": true                                           â”‚
â”‚    },                                                           â”‚
â”‚    "salario": {                                                 â”‚
â”‚      "sql_type": "FLOAT",                                       â”‚
â”‚      "nullable": true                                           â”‚
â”‚    },                                                           â”‚
â”‚    "activo": {                                                  â”‚
â”‚      "sql_type": "BIT",                                         â”‚
â”‚      "nullable": false,                                         â”‚
â”‚      "default_value": "0"                                       â”‚
â”‚    },                                                           â”‚
â”‚    "fecha": {                                                   â”‚
â”‚      "sql_type": "DATE",                                        â”‚
â”‚      "nullable": true                                           â”‚
â”‚    }                                                            â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       validators.py: normalize_dataframe_by_mappings()          â”‚
â”‚                                                                 â”‚
â”‚  Por cada columna:                                              â”‚
â”‚    1. Obtiene config (sql_type, nullable, default_value)        â”‚
â”‚    2. Por cada valor en la columna:                             â”‚
â”‚       â†’ Llama normalize_value_by_type(valor, config)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         validators.py: normalize_value_by_type()                â”‚
â”‚                                                                 â”‚
â”‚  ğŸ”¢ EDAD (INT, nullable=false):                                â”‚
â”‚    - "25" â†’ 25 (convertir string a int)                        â”‚
â”‚    - None â†’ 0 (default porque no nullable)                     â”‚
â”‚    - "30" â†’ 30                                                  â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ NOMBRE (NVARCHAR, nullable=true):                          â”‚
â”‚    - "Juan" â†’ "Juan" (preservar)                               â”‚
â”‚    - "MarÃ­a" â†’ "MarÃ­a"                                         â”‚
â”‚    - None â†’ None (nullable=true permite NULL)                  â”‚
â”‚                                                                 â”‚
â”‚  ğŸ’° SALARIO (FLOAT, nullable=true):                            â”‚
â”‚    - "1500.50" â†’ 1500.50 (convertir a float)                   â”‚
â”‚    - "2000" â†’ 2000.0                                            â”‚
â”‚    - None â†’ None (nullable=true)                               â”‚
â”‚                                                                 â”‚
â”‚  âœ… ACTIVO (BIT, nullable=false):                              â”‚
â”‚    - "true" â†’ 1 (mapear true â†’ 1)                              â”‚
â”‚    - "false" â†’ 0 (mapear false â†’ 0)                            â”‚
â”‚    - "1" â†’ 1                                                    â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“… FECHA (DATE, nullable=true):                               â”‚
â”‚    - "2024-01-15" â†’ datetime(2024, 1, 15)                      â”‚
â”‚    - None â†’ None (nullable=true)                               â”‚
â”‚    - "2024-03-30" â†’ datetime(2024, 3, 30)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 DATAFRAME NORMALIZADO (RESULTADO)               â”‚
â”‚                                                                 â”‚
â”‚   edad    nombre     salario    activo    fecha                â”‚
â”‚   25      "Juan"     1500.50    1         2024-01-15           â”‚
â”‚   0       "MarÃ­a"    2000.0     0         None                 â”‚
â”‚   30      None       None       1         2024-03-30           â”‚
â”‚   â†‘       â†‘          â†‘          â†‘         â†‘                    â”‚
â”‚   âœ…      âœ…         âœ…         âœ…        âœ…                    â”‚
â”‚   Noneâ†’0  NULL OK    NULL OK    falseâ†’0   NULL OK              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”€ DECISIONES DE NORMALIZACIÃ“N (ÃRBOL DE DECISIÃ“N)

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Valor de entradaâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    Â¿Es NULL o vacÃ­o?
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚
                   SÃ                NO
                    â”‚                 â”‚
                    â–¼                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Â¿nullable=true?  â”‚   â”‚ Convertir    â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â”‚ segÃºn tipo   â”‚
              â”‚         â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             SÃ        NO
              â”‚         â”‚
              â–¼         â–¼
         Retornar   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           NULL     â”‚ Â¿Tipo de dato SQL? â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚        â”‚        â”‚        â”‚
               INT    FLOAT   VARCHAR    DATE
                â”‚        â”‚        â”‚        â”‚
                â–¼        â–¼        â–¼        â–¼
            Retornar  Retornar Retornar  Retornar
               0        0.0      ''    GETDATE()
```

---

## ğŸ§© COMPONENTES DEL SISTEMA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VALIDATORS.PY (CORE)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1ï¸âƒ£ normalize_name()                                        â”‚
â”‚     Entrada: "Ventas 2024!"                                  â”‚
â”‚     Salida: "ventas_2024"                                    â”‚
â”‚     Uso: Nombres de tablas y columnas SQL-safe              â”‚
â”‚                                                              â”‚
â”‚  2ï¸âƒ£ validate_sheet_name()                                   â”‚
â”‚     Entrada: "Hoja1", ["hoja_existente"]                     â”‚
â”‚     Salida: (is_valid, normalized, error)                    â”‚
â”‚     Uso: ValidaciÃ³n en tiempo real de renombrado            â”‚
â”‚                                                              â”‚
â”‚  3ï¸âƒ£ infer_sql_type()                                        â”‚
â”‚     Entrada: pandas.Series([1, 2, 3])                        â”‚
â”‚     Salida: {sql_type, confidence, nullable, default, ...}   â”‚
â”‚     Uso: Inferencia automÃ¡tica de tipos SQL                 â”‚
â”‚                                                              â”‚
â”‚  4ï¸âƒ£ normalize_value_by_type()                               â”‚
â”‚     Entrada: None, "INT", nullable=False                     â”‚
â”‚     Salida: 0                                                â”‚
â”‚     Uso: NormalizaciÃ³n individual de valores                â”‚
â”‚                                                              â”‚
â”‚  5ï¸âƒ£ normalize_dataframe_by_mappings()                       â”‚
â”‚     Entrada: DataFrame, column_mappings                      â”‚
â”‚     Salida: (df_normalizado, warnings)                       â”‚
â”‚     Uso: NormalizaciÃ³n completa de DataFrame                â”‚
â”‚                                                              â”‚
â”‚  6ï¸âƒ£ validate_column_mappings()                              â”‚
â”‚     Entrada: DataFrame, column_mappings                      â”‚
â”‚     Salida: (is_valid, errors)                               â”‚
â”‚     Uso: ValidaciÃ³n de configuraciÃ³n antes de procesar      â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VIEWS.PY (ENDPOINTS)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ğŸŒ upload_excel_file()                                      â”‚
â”‚     Route: POST /automatizacion/upload/                      â”‚
â”‚     FunciÃ³n: Guarda Excel, redirect a multi-config           â”‚
â”‚                                                              â”‚
â”‚  ğŸŒ excel_multi_sheet_config()                               â”‚
â”‚     Route: GET /automatizacion/excel/<id>/multi-config/      â”‚
â”‚     FunciÃ³n: Renderiza UI con datos e inferencia de tipos    â”‚
â”‚                                                              â”‚
â”‚  ğŸŒ validate_sheet_rename() ğŸ†•                               â”‚
â”‚     Route: POST /automatizacion/validate-sheet-rename/       â”‚
â”‚     FunciÃ³n: Valida renombrado de hoja en tiempo real        â”‚
â”‚                                                              â”‚
â”‚  ğŸŒ infer_column_types() ğŸ†•                                  â”‚
â”‚     Route: POST /automatizacion/excel/<id>/infer-types/      â”‚
â”‚     FunciÃ³n: Infiere tipos SQL de columnas (AJAX)            â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MODELS.PY (PROCESAMIENTO)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ğŸ“Š MigrationProcess                                         â”‚
â”‚     Campos:                                                  â”‚
â”‚       - column_mappings: JSON                                â”‚
â”‚       - type_configuration: JSON ğŸ†•                          â”‚
â”‚       - types_inferred_at: DateTime ğŸ†•                       â”‚
â”‚                                                              â”‚
â”‚     MÃ©todos:                                                 â”‚
â”‚       - run(): Ejecuta proceso completo                      â”‚
â”‚       - _save_dataframe_to_destination(): Inserta en SQL     â”‚
â”‚         ğŸ†• Llama validate_column_mappings()                  â”‚
â”‚         ğŸ†• Llama normalize_dataframe_by_mappings()           â”‚
â”‚         ğŸ†• Logging mejorado                                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TEMPLATE (EXCEL_MULTI_SHEET_SELECTOR.HTML)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ğŸ¨ SecciÃ³n 1: Renombrado de Hoja Activa ğŸ†•                  â”‚
â”‚     - Input de renombrado                                    â”‚
â”‚     - BotÃ³n "Validar"                                        â”‚
â”‚     - Feedback en tiempo real                                â”‚
â”‚                                                              â”‚
â”‚  ğŸ¨ SecciÃ³n 2: Lista de Columnas                             â”‚
â”‚     - BotÃ³n "Seleccionar todas" (movido debajo) ğŸ†•           â”‚
â”‚     - Checkboxes de columnas                                 â”‚
â”‚     - ConfiguraciÃ³n expandible por campo ğŸ†•                  â”‚
â”‚                                                              â”‚
â”‚  ğŸ¨ SecciÃ³n 3: ConfiguraciÃ³n por Campo ğŸ†•                    â”‚
â”‚     - Input renombrar columna                                â”‚
â”‚     - Selector tipo SQL (con inferencia automÃ¡tica)          â”‚
â”‚     - Checkbox "Puede ser NULL"                              â”‚
â”‚     - Input "Valor por defecto" (fix bug habilitaciÃ³n)       â”‚
â”‚     - Placeholder dinÃ¡mico segÃºn tipo SQL                    â”‚
â”‚                                                              â”‚
â”‚  âš™ï¸ JavaScript:                                              â”‚
â”‚     - updateColumnSelection() ğŸ”§                             â”‚
â”‚     - toggleDefaultInput() ğŸ”§ FIX BUG                        â”‚
â”‚     - inferTypeForColumn() ğŸ†•                                â”‚
â”‚     - updatePlaceholderForType() ğŸ†•                          â”‚
â”‚     - validateSheetRename() ğŸ†•                               â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š TABLA DE DECISIONES - NORMALIZACIÃ“N POR TIPO

| Tipo SQL | Valor Entrada | nullable=TRUE | nullable=FALSE | Ejemplo |
|----------|---------------|---------------|----------------|---------|
| **INT** | `None` / `''` | `None` | `0` | NULL â†’ 0 |
| **INT** | `'123'` | `123` | `123` | "123" â†’ 123 |
| **INT** | `'abc'` | `None` | `0` | InvÃ¡lido â†’ default |
| **FLOAT** | `None` / `''` | `None` | `0.0` | NULL â†’ 0.0 |
| **FLOAT** | `'12.5'` | `12.5` | `12.5` | "12.5" â†’ 12.5 |
| **VARCHAR** | `None` / `''` | `None` | `''` | NULL â†’ '' |
| **VARCHAR** | `'Hola'` | `'Hola'` | `'Hola'` | Preserva |
| **DATE** | `None` / `''` | `None` | `GETDATE()` | NULL â†’ fecha actual |
| **DATE** | `'2024-01-15'` | `datetime(...)` | `datetime(...)` | ISO â†’ datetime |
| **BIT** | `'true'` | `1` | `1` | true â†’ 1 |
| **BIT** | `'false'` | `0` | `0` | false â†’ 0 |
| **BIT** | `'yes'` | `1` | `1` | yes â†’ 1 |
| **BIT** | `'sÃ­'` | `1` | `1` | sÃ­ â†’ 1 |
| **BIT** | `None` / `''` | `None` | `0` | NULL â†’ 0 |

---

**Ãšltima actualizaciÃ³n**: 15 de Mayo de 2025  
**VersiÃ³n**: 1.0.0
